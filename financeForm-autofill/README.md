# FinanceForm-autocomplete

These are two javascript functions to copypaste in my browser's console when I'm filling my invoicing forms.

**Vanilla javascript**

## Initial situation

I have to enter several information on a finance form generated by an internal tool. The tool was developped internally, this is not a public release. The tool lets me create one invoice at a time. I can clone previous invoices as templates, but the task is quite long and manually repeating the same actions leads to a lot of errors. This is not a big problem per se, because I can cancel wrong invoices and they are checked behind me so my colleague may reject it in case of mistakes.

I produce invoices in large batches and my colleague does not go through a full review all the time and the accounting team, who is at the end of the approval process has no mean to know if there is a mistake or not. As a result, they would approve and issue an invoice that has to be canceled later with a heavier process in case of mistake (and sending at least 3 e-mails to the invoiced participant: wrong invoice + cancellation + new invoice).

I need a way to prepare invormation in advance so that I can check them all against each other before validation. The obvious solution would be an excel file or such, but I wanted a programatic solution just to show off and feel like I'm a `|-| @ [ |< 3 |2` lol.

## Key elements

I can clone previous invoices as templates.

I have no idea about the API and the trafic with this platform is fully encrypted. I tried to sniff the content of POST requests with wireshark and my browser, but no way to get anything that would let me send a batch of POST requests with postman, for instance. Due to the financial nature of these forms, I guess I can't count on any help to ease my process. Fair enough.

I can inspect the page and send javascript through the console, though! ;D

The behaviour of the page is weird and some part of the form is held in a popup `<iframe>`, which made my attempts unexpectedly difficult for a reason that I do not fully understand. This is an internally developed tool, so no documentation available to help understand the situation.

## Code

On the principle, the task is dead simple:

* get the fields to fill in the form
* send text
* validate

On the practical side, I made two functions : `autoCompleter1`and `autoCompleter2` that I would copy paste one after the other. The issue here is that when the first button is clicked, the following form appears as a popup `<iframe>`.

If I try to run `autoCompleter2` immediately when the popup appears, the form is not detected `const secondTable = document.getElementById("docContents");` returns that it couldn't find "#docContents". However, when I inspect the page, the `<form>` is displayed from within the `<iframe>` and I can now run `autoCompleter2` successfully.

I tried `setTimeout` and `setInterval` to run `autoCompleter2` after some delay. I also tried with `onload` events and such, with no more success. As long as I do not inspect the code, the `<form>` is impossible to retrieve.

Oh well. At this point, I'm not gaining any more time, so I may just go with it. The console is opened anyway. I may just switch tabs to inspector and back to console to run my second function.

I do not bother that much because the `autoCompleter1` is the most fcritical function. The participant name changes everytime, but the price may be the same as a previous invoice that I can clone.

## Usage

I may prepare in advance the two functions to paste in the console:

`autoCompleter1("Firstname LASTNAME", "Please send the invoice by email to : a@b.com");`

`autoCompleter2("Course category", "Module Name", "42", "Message to the invoice recipient.");`

This way, I have all information for all participants, lets say in a text document. Once I am sure of the information, that are usually not very long and very often repetitive, I can proceed with my invoicing.

I go to the platform and clone a previous invoice that would possibly prevent me from using `autoCompleter2`. If the said previous invoice is too old, I have a better time cloning any invoice and fill it with `autoCompleter2`.

I open the console, paste the definition code for `autoCompleter1` and run the `autoCompleter1("Firstname LASTNAME", "Please send the invoice by email to : a@b.com");` command.

If needed, I do the same with `autoCompleter2`.

If not, I sign and proceed to the next invoice.

## Conclusion

This process is far from optimal, but it's a bit of fun and it lets me prepare all forms in advance saving me the trouble to copy-paste multiple line from a preparation file to the multiple `<input>`. I'm saving only a few minutes here and there, but hey, better than nothing!

Getting `autoCompleter2` to run automatically would have been the critical success, but this will remain an enigma...

The advantage of these functions is that they are easy to adapt to many different types of invoices that I have to fill and some of them have many lines that I can fill faster with `autoCompleter2` alone.

I found a bit of success in my failure. :)
